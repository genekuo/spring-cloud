./gradlew build && docker-compose build

./test-all.sh start

docker-compose ps gateway eureka product-composite product recommendation review

curl localhost:8080/actuator/gateway/routes -s | jq '.[] | {"\(.route_id)": "\(.route_definition.predicates[0].args._genkey_0)"}'

docker-compose logs -f --tail=0 gateway

curl localhost:8080/product-composite/2

curl -H "accept:application/json" localhost:8080/eureka/api/apps -s | jq -r '.applications.application[].instance[].instanceId'

http://localhost:8080/eureka/web

curl http://localhost:8080/headerrouting -H "Host: i.feel.lucky:8080"
curl http://localhost:8080/headerrouting -H "Host: im.a.teapot:8080"
curl http://localhost:8080/headerrouting

sudo bash -c "echo '127.0.0.1 i.feel.lucky im.a.teapot' >> /etc/hosts"

curl http://i.feel.lucky:8080/headerrouting
curl http://im.a.teapot:8080/headerrouting

docker-compose down

[clean up]
docker stop $(docker ps -a -q)
docker rm $(docker ps -a -q)
docker rmi $(docker images -a -q)
